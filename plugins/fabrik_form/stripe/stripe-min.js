/*! Fabrik */
define(["jquery","fab/fabrik"],function(a,b){"use strict";var c=new Class({options:{publicKey:"",item:"",zipCode:!0,allowRememberMe:!1,email:"",name:"",panelLabel:"",useCheckout:!0,billingAddress:!1},initialize:function(c){this.options=a.extend(this.options,c),b.FabrikStripeForm=null,b.FabrikStripeFormSubmitting=!1,this.options.useCheckout&&(this.handler=StripeCheckout.configure({key:this.options.publicKey,image:"https://stripe.com/img/documentation/checkout/marketplace.png",locale:"auto",token:function(a,c){b.FabrikStripeForm.form.adopt(new Element("input",{name:"stripe_token_id",value:a.id,type:"hidden"})),b.FabrikStripeForm.form.adopt(new Element("input",{name:"stripe_token_email",value:a.email,type:"hidden"})),b.FabrikStripeForm.form.adopt(new Element("input",{name:"stripe_token_opts",value:JSON.encode(c),type:"hidden"})),b.FabrikStripeForm.mockSubmit()},closed:function(){b.FabrikStripeFormSubmitting=!0}}),b.addEvent("fabrik.form.submit.start",function(a,c){("undefined"==typeof b.FabrikStripeForm||b.FabrikStripeFormSubmitting!==!0)&&(b.FabrikStripeForm=a,this.handler.open({name:this.options.name,description:this.options.item,amount:this.options.amount,zipCode:this.options.zipCode,allowRememberMe:this.options.allowRememberMe,email:this.options.email,panelLabel:this.options.panelLabel,billingAddress:this.options.billingAddress}),c.preventDefault(),a.result=!1)}.bind(this)),window.addEventListener("popstate",function(){this.handler.close()}))}});return c});